<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Font?>
<?import com.jfoenix.controls.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<BorderPane fx:controller="code.HomeController"
            maxHeight="-Infinity" maxWidth="-Infinity"
            minHeight="-Infinity" minWidth="-Infinity"
            prefHeight="617.0" prefWidth="985.0"
            stylesheets="@/style.css"
            xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            xmlns:jfoenix="http://jfoenix.com">

    <!-- Top Header -->
    <top>
        <HBox style="-fx-padding: 10; -fx-background-color: #f8f9fa;" alignment="CENTER_LEFT">
            <!-- App Title -->
            <Label text="Gestion des Créances" style="-fx-font-size: 20; -fx-font-weight: bold; -fx-text-fill: #2a64b8;"/>

            <!-- Spacer -->
            <Region HBox.hgrow="ALWAYS"/>

            <!-- Top-Right: [Déconnexion] [Administrateur 🛡️] -->
            <HBox spacing="10" alignment="CENTER_RIGHT">
                <!-- Logout Button -->
                <Button text="Déconnexion" onAction="#handleLogout"
                        style="-fx-background-color: #dc3545; -fx-text-fill: white; -fx-background-radius: 4; -fx-padding: 5 12;"/>

                <!-- Admin Label -->
                <HBox alignment="CENTER" spacing="5" style="-fx-background-color: #e9ecef; -fx-background-radius: 15; -fx-padding: 3 10;">
                    <Label fx:id="adminLabel" text="Administrateur" style="-fx-font-weight: bold;"/>
                    <ImageView fitWidth="16" fitHeight="16">

                    </ImageView>
                </HBox>
            </HBox>
        </HBox>
    </top>

    <!-- Left Side Menu -->
    <left>
        <VBox alignment="TOP_CENTER" prefWidth="180" style="-fx-background-color: #273c75; -fx-spacing: 15; -fx-padding: 20;">
            <children>
                <Label text="CreancePro" style="-fx-font-size: 15; -fx-font-weight: bold; -fx-text-fill: white;"/>
                <Separator style="-fx-padding: 5 0 5 0;"/>

                <Button fx:id="dashboardBtn" text="Tableau de bord" onAction="#showDashboard"
                        style="-fx-background-color: transparent; -fx-text-fill: white; -fx-alignment: CENTER_LEFT;">
                    <graphic>
                        <ImageView fitWidth="20" fitHeight="20">
                            <Image url="@/images/dashboard.png"/>
                        </ImageView>
                    </graphic>
                </Button>

                <Button fx:id="clientsBtn" text="Clients" onAction="#showClientsView"
                        style="-fx-background-color: transparent; -fx-text-fill: white; -fx-alignment: CENTER_LEFT;">
                    <graphic>
                        <ImageView fitWidth="20" fitHeight="20">
                            <Image url="@/images/supplier.png"/>
                        </ImageView>
                    </graphic>
                </Button>

                <Button fx:id="invoicesBtn" text="Factures" onAction="#showInvoicesView"
                        style="-fx-background-color: transparent; -fx-text-fill: white; -fx-alignment: CENTER_LEFT;">
                    <graphic>
                        <ImageView fitWidth="20" fitHeight="20">
                            <Image url="@/images/invoice.png"/>
                        </ImageView>
                    </graphic>
                </Button>

                <Button fx:id="paymentsBtn" text="Paiements" onAction="#showPaymentsView"
                        style="-fx-background-color: transparent; -fx-text-fill: white; -fx-alignment: CENTER_LEFT;">
                    <graphic>
                        <ImageView fitWidth="20" fitHeight="20">
                            <Image url="@/images/payment.png"/>
                        </ImageView>
                    </graphic>
                </Button>
            </children>
        </VBox>
    </left>

    <!-- Main Content -->
    <center>
        <VBox style="-fx-padding: 20;" spacing="10">
            <children>
                <Label text="Tableau de bord" style="-fx-font-size: 20; -fx-font-weight: bold;"/>

                <!-- Stats Cards -->
                <HBox spacing="20" style="-fx-padding: 10;">
                    <!-- Total créances -->
                    <VBox spacing="5" style="-fx-background-color: white; -fx-background-radius: 8; -fx-padding: 15; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 5, 0, 0, 2);">
                        <Label text="Total créances" style="-fx-text-fill: #7f8c8d; -fx-font-size: 12;"/>
                        <Label fx:id="totalCreancesLabel" text="34 881 DA" style="-fx-font-size: 20; -fx-font-weight: bold;"/>
                        <Label fx:id="creancesPercentage" text="12% depuis le mois dernier" style="-fx-text-fill: #888888; -fx-font-size: 11;"/>
                    </VBox>

                    <!-- Montant payé -->
                    <VBox spacing="5" style="-fx-background-color: white; -fx-background-radius: 8; -fx-padding: 15; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 5, 0, 0, 2);">
                        <Label text="Montant payé" style="-fx-text-fill: #7f8c8d; -fx-font-size: 12;"/>
                        <Label fx:id="paidAmountLabel" text="15 701 DA" style="-fx-font-size: 20; -fx-font-weight: bold;"/>
                        <Label fx:id="paidPercentage" text="8% depuis le mois dernier" style="-fx-text-fill: #888888; -fx-font-size: 11;"/>
                    </VBox>

                    <!-- Paiements en attente -->
                    <VBox spacing="5" style="-fx-background-color: white; -fx-background-radius: 8; -fx-padding: 15; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 5, 0, 0, 2);">
                        <Label text="Paiements en attente" style="-fx-text-fill: #7f8c8d; -fx-font-size: 12;"/>
                        <Label fx:id="pendingInvoicesLabel" text="4 Factures" style="-fx-font-size: 20; -fx-font-weight: bold;"/>
                        <Label fx:id="pendingAmountLabel" text="25 681 DA" style="-fx-text-fill: #888888; -fx-font-size: 11;"/>
                    </VBox>

                    <!-- Paiements en retard -->
                    <VBox spacing="5" style="-fx-background-color: white; -fx-background-radius: 8; -fx-padding: 15; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 5, 0, 0, 2);">
                        <Label text="Paiements en retard" style="-fx-text-fill: #7f8c8d; -fx-font-size: 12;"/>
                        <Label fx:id="lateInvoicesLabel" text="2 Factures" style="-fx-font-size: 20; -fx-font-weight: bold;"/>
                        <Label fx:id="lateAmountLabel" text="11 200 DA" style="-fx-text-fill: #888888; -fx-font-size: 11;"/>
                        <Label fx:id="latePercentage" text="5% depuis le mois dernier" style="-fx-text-fill: #888888; -fx-font-size: 11;"/>
                    </VBox>
                </HBox>

                <!-- Recent Invoices Table -->
                <VBox spacing="10">
                    <Label text="Factures Récentes" style="-fx-font-size: 18; -fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
                    <TableView fx:id="invoicesTable" styleClass="table-view" prefHeight="300" prefWidth="792">
                        <columns>
                            <TableColumn fx:id="refColumn" text="Référence" prefWidth="150"/>
                            <TableColumn fx:id="clientColumn" text="Client" prefWidth="200"/>
                            <TableColumn fx:id="dueDateColumn" text="Date d'échéance" prefWidth="150"/>
                            <TableColumn fx:id="amountColumn" text="Montant" prefWidth="100"/>
                            <TableColumn fx:id="statusColumn" text="Statut" prefWidth="100"/>
                        </columns>
                    </TableView>
                </VBox>
            </children>
        </VBox>
    </center>
</BorderPane>